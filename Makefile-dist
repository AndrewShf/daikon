# Main Makefile for Daikon

all:
	$(MAKE) -C bin
ifdef $DAIKONCLASS_SOURCES
	$(MAKE) -C java
endif
# This ought to check the output of /bin/arch as well:  it needs x86.
ifeq (Linux,$(shell uname))
	$(MAKE) kvasir
endif

clean:
	$(MAKE) -C bin clean
ifdef $DAIKONCLASS_SOURCES
	$(MAKE) -C java clean
endif
	$(MAKE) -C clean

kvasir:
	cd kvasir/vex && make
	cd kvasir/valgrind && ./configure --prefix=`pwd`/../inst --with-vex=`pwd`/../vex
	cd kvasir/valgrind && make
	cd kvasir/valgrind && make install

dfej: java-front-end

java-front-end: front-end/java/config.status
	@echo "If this command fails, see 'Installing dfej' section in manual"
	$(MAKE) -C front-end/java

front-end/java/config.status:
	@echo "If this command fails, see 'Installing dfej' section in manual"
	cd front-end/java && ./configure

.PHONY: java-front-end kvasir
.SECONDARY: front-end/java/config.status
